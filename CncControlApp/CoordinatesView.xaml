<UserControl x:Class="CncControlApp.CoordinatesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:CncControlApp"
             mc:Ignorable="d" 
             d:DesignHeight="960" d:DesignWidth="715" 
             Margin="5,10,5,0" Background="#FF2D2D30">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

        <!-- Axis Label Style -->
        <Style x:Key="AxisLabelStyle" TargetType="Label">
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- NEW: Unified dark rounded coordinate action button style (accent comes from Foreground) -->
        <Style x:Key="DarkCoordButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF3E3E40"/>
            <Setter Property="BorderBrush" Value="#FF2A2A2C"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="#FFDDDDDD"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Root"
                                CornerRadius="10"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <Grid>
                                <ContentPresenter Margin="{TemplateBinding Padding}"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                <Border x:Name="HoverOverlay"
                                        CornerRadius="10"
                                        Background="#10FFFFFF"
                                        Visibility="Collapsed"/>
                                <Border x:Name="PressedOverlay"
                                        CornerRadius="10"
                                        Background="#33000000"
                                        Visibility="Collapsed"/>
                            </Grid>
                            <Border.Effect>
                                <DropShadowEffect ShadowDepth="2" BlurRadius="6" Opacity="0.25" Color="#000000"/>
                            </Border.Effect>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="HoverOverlay" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="Root" Property="Background" Value="#FF4A4A4C"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="HoverOverlay" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="PressedOverlay" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="Root" Property="Background" Value="#FF2D2D2F"/>
                                <Setter TargetName="Root" Property="BorderBrush" Value="#FF1E1E20"/>
                                <Setter TargetName="Root" Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                <Setter TargetName="Root" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.97" ScaleY="0.97"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Root" Property="Opacity" Value="0.55"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Coordinate TextBox Style -->
        <Style x:Key="UnifiedCoordinateStyle" TargetType="TextBox">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="34"/>
            <Setter Property="FontWeight" Value="Regular"/>
            <Setter Property="FontFamily" Value="Consolas, 'Courier New', monospace"/>
            <Setter Property="Padding" Value="0,0,10,0"/>
            <Setter Property="TextAlignment" Value="Right"/>
            <Setter Property="Background" Value="#FF2D3D2D"/>
            <Setter Property="Foreground" Value="#FF4CAF50"/>
            <Setter Property="BorderBrush" Value="#FF4CAF50"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
            <Style.Triggers>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsFocused" Value="True"/>
                        <Condition Property="IsReadOnly" Value="False"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="BorderBrush" Value="#FFFF6600"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </MultiTrigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                        <Condition Property="IsReadOnly" Value="False"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="BorderBrush" Value="#FF70D03A"/>
                </MultiTrigger>
                <Trigger Property="IsReadOnly" Value="True">
                    <Setter Property="Background" Value="#FF2D3D2D"/>
                    <Setter Property="Foreground" Value="#FF4CAF50"/>
                    <Setter Property="BorderBrush" Value="#FF4CAF50"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Panel Header Style -->
        <Style x:Key="PanelHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,10,0,20"/>
        </Style>

        <!-- Local Panel Style -->
        <Style x:Key="LocalPanelStyle" TargetType="Border">
            <Setter Property="Background" Value="#FF424242"/>
            <Setter Property="BorderBrush" Value="#FF4CAF50"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="5"/>
        </Style>

        <!-- Machine Panel Style -->
        <Style x:Key="MachinePanelStyle" TargetType="Border">
            <Setter Property="Background" Value="#FF424242"/>
            <Setter Property="BorderBrush" Value="#FF2196F3"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
    </UserControl.Resources>

    <Border Background="#FF2D2D30"
            CornerRadius="15"
            Margin="0,0,0,5"
            BorderBrush="#FFA2A2A4"
            BorderThickness="2">
        <Grid x:Name="MainGrid" Margin="15,15,15,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="123*"/>
                <ColumnDefinition Width="14*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- ROW 0 - LOCAL COORDINATES PANEL -->
            <Border x:Name="LocalCoordinatesBorder" Grid.Row="0" Style="{StaticResource LocalPanelStyle}" BorderThickness="1" BorderBrush="#FFA2A2A4" Margin="5,5,5,5" Background="#FF2D2D30" Grid.ColumnSpan="2">
                <StackPanel>
                    <TextBlock Text="LOCAL COORDINATES" Style="{StaticResource PanelHeaderStyle}" Margin="0,5,0,15"/>

                    <Grid HorizontalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Margin="0,0,20,0">
                            <Label Content="X" Style="{StaticResource AxisLabelStyle}" Height="60" Margin="0,0,0,15"/>
                            <Label Content="Y" Style="{StaticResource AxisLabelStyle}" Height="60" Margin="0,0,0,15"/>
                            <Label Content="Z" Style="{StaticResource AxisLabelStyle}" Height="60" Margin="0,0,0,15"/>
                            <Label Content="A" Style="{StaticResource AxisLabelStyle}" Height="60" Margin="0,0,0,15"
                                   Visibility="{Binding IsAAxisAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Margin="0,0,20,0">
                            <TextBox x:Name="TextBoxX" 
                                     Text="{Binding TargetX, UpdateSourceTrigger=PropertyChanged}" 
                                     Style="{StaticResource UnifiedCoordinateStyle}" 
                                     Height="60" Width="200" Margin="0,0,0,15" 
                                     TextChanged="CoordinateTextBox_TextChanged" 
                                     PreviewTextInput="NumericTextBox_PreviewTextInput"
                                     PreviewKeyDown="NumericTextBox_PreviewKeyDown"
                                     Tag="X" HorizontalAlignment="Left"/>
                            <TextBox x:Name="TextBoxY" 
                                     Text="{Binding TargetY, UpdateSourceTrigger=PropertyChanged}" 
                                     Style="{StaticResource UnifiedCoordinateStyle}" 
                                     Height="60" Width="200" Margin="0,0,0,15" 
                                     TextChanged="CoordinateTextBox_TextChanged" 
                                     PreviewTextInput="NumericTextBox_PreviewTextInput"
                                     PreviewKeyDown="NumericTextBox_PreviewKeyDown"
                                     Tag="Y"/>
                            <TextBox x:Name="TextBoxZ" 
                                     Text="{Binding TargetZ, UpdateSourceTrigger=PropertyChanged}" 
                                     Style="{StaticResource UnifiedCoordinateStyle}" 
                                     Height="60" Width="200" Margin="0,0,0,15" 
                                     TextChanged="CoordinateTextBox_TextChanged" 
                                     PreviewTextInput="NumericTextBox_PreviewTextInput"
                                     PreviewKeyDown="NumericTextBox_PreviewKeyDown"
                                     Tag="Z"/>
                            <TextBox x:Name="TextBoxA" 
                                     Text="{Binding TargetA, UpdateSourceTrigger=PropertyChanged}" 
                                     Style="{StaticResource UnifiedCoordinateStyle}" 
                                     Height="60" Width="200" Margin="0,0,0,15" 
                                     TextChanged="CoordinateTextBox_TextChanged" 
                                     PreviewTextInput="NumericTextBox_PreviewTextInput"
                                     PreviewKeyDown="NumericTextBox_PreviewKeyDown"
                                     Tag="A"
                                     Visibility="{Binding IsAAxisAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="60"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"/>
                                    <ColumnDefinition Width="15"/>
                                    <ColumnDefinition Width="140"/>
                                </Grid.ColumnDefinitions>

                                <!-- Set Zero Buttons (accent: previous background colors) -->
                                <Button Grid.Row="0" Grid.Column="0"
                                        Content="Set Zero X"
                                        Style="{StaticResource DarkCoordButtonStyle}"
                                        Foreground="White"
                                        Click="SetZeroButton_Click"
                                        Tag="X" FontWeight="Bold" FontSize="11" BorderBrush="#FF2A2A2C" Background="#FF474A50" FontFamily="Raleway"/>

                                <Button Grid.Row="2" Grid.Column="0"
                                        Content="Set Zero Y"
                                        Style="{StaticResource DarkCoordButtonStyle}"
                                        Foreground="#FFFCFDFF"
                                        Click="SetZeroButton_Click"
                                        Tag="Y" Background="#FF474A50" FontFamily="Raleway" FontWeight="Bold"/>

                                <Button Grid.Row="4" Grid.Column="0"
                                        Content="Set Zero Z"
                                        Style="{StaticResource DarkCoordButtonStyle}"
                                        Foreground="#FFFCFDFF"
                                        Click="SetZeroButton_Click"
                                        Tag="Z" Background="#FF474A50" FontWeight="Bold" FontFamily="Raleway" BorderBrush="#FF2A2A2C"/>

                                <Button Grid.Row="6" Grid.Column="0"
                                        Content="Set Zero A"
                                        Style="{StaticResource DarkCoordButtonStyle}"
                                        Foreground="#FFFCFDFF"
                                        Click="SetZeroButton_Click"
                                        Tag="A"
                                        Visibility="{Binding IsAAxisAvailable, Converter={StaticResource BooleanToVisibilityConverter}}" Background="#FF474A50" FontWeight="Bold" FontFamily="Raleway" BorderBrush="#FF2A2A2C"/>

                                <!-- Park A Button (accent: former blue) -->
                                <Button Grid.Row="6" Grid.Column="2"
                                        Style="{StaticResource DarkCoordButtonStyle}"
                                        Foreground="#FFFCFDFF"
                                        Click="HomeButton_Click"
                                        Tag="A"
                                        ToolTip="A axis moves to park position (0°)"
                                        Visibility="{Binding IsAAxisAvailable, Converter={StaticResource BooleanToVisibilityConverter}}" Background="#FF474A50" FontFamily="Raleway" FontWeight="Normal" BorderBrush="#FF2A2A2C">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Border Background="#332196F3"
                                                BorderBrush="#FF8DFFB1"
                                                BorderThickness="1"
                                                CornerRadius="15"
                                                Width="30" Height="30"
                                                Margin="0,0,15,0">
                                            <TextBlock Text="℗"
                                                       FontSize="24"
                                                       FontWeight="Bold"
                                                       Foreground="#FFFCFDFF"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                                        </Border>
                                        <TextBlock Text="Park A"
                                                   FontSize="11"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFCFDFF"
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>

                                <!-- Park XYZ Button -->
                                <Button Grid.Row="0" Grid.RowSpan="5" Grid.Column="2"
                                        Style="{StaticResource DarkCoordButtonStyle}"
                                        Foreground="#FFFCFDFF"
                                        Click="HomeXYZButton_Click"
                                        FontSize="11"
                                        FontWeight="Bold"
                                        ToolTip="X, Y, Z axes move to park (X=0, Y=0, Z=40)" Background="#FF474A50" FontFamily="Raleway" BorderBrush="#FF2A2A2C">
                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Border
                                                BorderBrush="#FF8DFFB1"
                                                BorderThickness="1"
                                                CornerRadius="20"
                                                Width="64" Height="64"
                                                Margin="0,0,0,12" Background="#FF2F405A">
                                            <TextBlock Text="℗"
                                                       FontSize="34"
                                                       FontWeight="Bold"
                                                       Foreground="#FFFCFDFF"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                                        </Border>
                                        <TextBlock Text="Park"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFCFDFF"
                                                   HorizontalAlignment="Center"
                                                   Margin="0,0,0,2"/>
                                        <TextBlock Text="XYZ"
                                                   FontSize="13"
                                                   FontWeight="Bold"
                                                   Foreground="#FFFCFDFF"
                                                   HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- ROW 1 - MACHINE COORDINATES PANEL -->
            <Border x:Name="MachineCoordinatesBorder" Grid.Row="1" Style="{StaticResource MachinePanelStyle}" BorderThickness="1" Margin="5,5,5,5" Padding="15,15,15,10" Background="#FF2D2D30" Grid.ColumnSpan="2">
                <Border.BorderBrush>
                    <SolidColorBrush Color="#FFA2A2A4"/>
                </Border.BorderBrush>
                <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top">
                    <TextBlock Text="MACHINE COORDINATES" Style="{StaticResource PanelHeaderStyle}" Margin="0,5,0,15"/>

                    <Grid HorizontalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Margin="0,0,20,0">
                            <Label Content="X" Style="{StaticResource AxisLabelStyle}" Height="60" Margin="0,0,0,15"/>
                            <Label Content="Y" Style="{StaticResource AxisLabelStyle}" Height="60" Margin="0,0,0,15"/>
                            <Label Content="Z" Style="{StaticResource AxisLabelStyle}" Height="60" Margin="0,0,0,15"/>
                            <Label Content="A" Style="{StaticResource AxisLabelStyle}" Height="60" Margin="0,0,0,15"
                                   Visibility="{Binding IsAAxisAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Margin="0,0,20,0">
                            <TextBox Text="{Binding MStatus.X, StringFormat=F3}"
                                     Style="{StaticResource UnifiedCoordinateStyle}"
                                     Height="60" Width="200" Margin="0,0,0,15" IsReadOnly="True"/>
                            <TextBox Text="{Binding MStatus.Y, StringFormat=F3}"
                                     Style="{StaticResource UnifiedCoordinateStyle}"
                                     Height="60" Width="200" Margin="0,0,0,15" IsReadOnly="True"/>
                            <TextBox Text="{Binding MStatus.Z, StringFormat=F3}"
                                     Style="{StaticResource UnifiedCoordinateStyle}"
                                     Height="60" Width="200" Margin="0,0,0,15" IsReadOnly="True"/>
                            <TextBox Text="{Binding MStatus.A, StringFormat=F3}"
                                     Style="{StaticResource UnifiedCoordinateStyle}"
                                     Height="60" Width="200" Margin="0,0,0,15" IsReadOnly="True"
                                     Visibility="{Binding IsAAxisAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="60"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"/>
                                    <ColumnDefinition Width="15"/>
                                    <ColumnDefinition Width="140"/>
                                </Grid.ColumnDefinitions>

                                <!-- Machine Home All (accent: keep icon color, button accent blue) -->
                                <Button Grid.Row="0" Grid.RowSpan="5" Grid.Column="0" Grid.ColumnSpan="3"
                                        Style="{StaticResource DarkCoordButtonStyle}"
                                        Foreground="#FF789FBF"
                                        Click="FluidNCHomeAllButton_Click"
                                        FontSize="11"
                                        FontWeight="Bold"
                                        ToolTip="FluidNC $H - X,Y,Z axes go to limit switches (Machine Home)" Background="#FF474A50" FontFamily="Raleway">
                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Viewbox Width="40" Height="40" Margin="0,0,0,8" OpacityMask="#FFA3EE9F">
                                            <Canvas Width="24" Height="24">
                                                <Path Fill="#FF789FBF"
                                                      Data="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/>
                                            </Canvas>
                                        </Viewbox>
                                        <TextBlock Text="Machine"
                                                   FontSize="20"
                                                   FontWeight="Bold"
                                                   Foreground="#FFDEDEDE"
                                                   HorizontalAlignment="Center"
                                                   Margin="0,0,0,2"/>
                                        <TextBlock Text="Home All"
                                                   FontSize="20"
                                                   FontWeight="Bold"
                                                   HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</UserControl>